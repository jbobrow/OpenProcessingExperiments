
//December 22nd 2009
//Pillow version 2.0
//Owaun Scantlebury

public String rmode = "P3D"; //"OPENGL";

public String [][] op; //openprocessing-sketches

void setopstrings(){
  // February 2008
  op[1][1]= "1";
  op[1][2] = "http://www.openprocessing.org/visuals/applets/visual2c7dd4ed88b4fa3b8872fd64a396a889/smallImage.jpg";
  op[1][3] = "Swirlies";
  op[1][4]= "February";
  op[1][5] ="2008";

  op[2][1]= "2";
  op[2][2]= "http://www.openprocessing.org/visuals/applets/visual87b2be49b09a59f34ff477092da606a0/smallImage.jpg";
  op[2][3]= "Phyllotax 3";
  op[2][4]= "March";
  op[2][5]= "2008";


  op[3][0]="April 2008 4 images : Fluid Dynamics, Fractal Fern, OBJ File Reader, Built with procesing 03"  ;
  op[3][1]= "3";
  op[3][2]= "http://www.openprocessing.org/visuals/applets/visualcef10e094c20acf5aa4891c0cfc0f245/smallImage.jpg";
  op[3][3]= "http://www.openprocessing.org/visuals/applets/visualf40753a4913b3c6e272e3637cfe34fb3/smallImage.jpg";
  op[3][4]= "http://www.openprocessing.org/visuals/applets/visuala80b84ae11fed21b36a3283b81f2c389/smallImage.jpg";
  op[3][5]= "http://www.openprocessing.org/visuals/applets/visual0559ec349566eea5cea82301989c9fb7/smallImage.jpg";


  op[4][1]= "4";
  op[4][2]= "http://www.openprocessing.org/visuals/applets/visualbe51087de734beb61b6d647596fd2897/smallImage.jpg";
  op[4][3]= "Bursting Attractor";
  op[4][4]= "May";
  op[4][5]= "2008";


  op[5][0] = "June 2008 " ;           
  op[5][1]= "5";
  op[5][2]= "http://www.openprocessing.org/visuals/applets/visual8b04bac7c06ab8f9395f284f574c143a/smallImage.jpg";
  op[5][3]= "http://www.openprocessing.org/visuals/applets/visual2e3bbf08ca72e544b26f69347b4c63a1/smallImage.jpg";
  op[5][4]= "http://www.openprocessing.org/visuals/applets/visual5053455f6da0f70e4092845949339464/smallImage.jpg";
  op[5][5]= "http://www.openprocessing.org/visuals/applets/visual2893c5808d64e5e8a0217decf687dbda/smallImage.jpg";

  op[6][0]= "July 2008 ";
  op[6][1]= "6";
  op[6][2]= "http://www.openprocessing.org/visuals/applets/visualcf6a55b62cb681379b764e453a6da5fd/smallImage.jpg";
  op[6][3]= "http://www.openprocessing.org/visuals/applets/visualbfc184cad441afa955b1c43903216320/smallImage.jpg";
  op[6][4]= "http://www.openprocessing.org/visuals/applets/visualf14bc1858d93f5bd347ba48bffdea5f0/smallImage.jpg";
  op[6][5]= "http://www.openprocessing.org/visuals/applets/visual998e30d29efcbc8676bf579a1c41a9a1/smallImage.jpg";

  op[7][0] = "August 2008";
  op[7][1]= "7";
  op[7][2]= "http://www.openprocessing.org/visuals/applets/visual025d2a30f0ce0ee0c5bea799de1cc93d/smallImage.jpg";
  op[7][3]= "http://www.openprocessing.org/visuals/applets/visual1aad99d6b24c53e6d62ebffa00acf3d4/smallImage.jpg";
  op[7][4]= "http://www.openprocessing.org/visuals/applets/visual11c5ca2e8c1748286e169af717f3a588/smallImage.jpg";
  op[7][5]= "http://www.openprocessing.org/visuals/applets/visual1aad99d6b24c53e6d62ebffa00acf3d4/smallImage.jpg";


  op[8][1]= "8";
  op[8][2]= "http://www.openprocessing.org/visuals/applets/visual710771974321d7c63c3c12be028e925b/smallImage.jpg";
  op[8][3]= "Colour Line mixer";
  op[8][4]= "September";
  op[8][5]= "2008";

  op[9][0]="October 008";
  op[9][1]= "9";
  op[9][2]= "http://www.openprocessing.org/visuals/applets/visuald8c53575101a41eee73db1822d003cd9/smallImage.jpg";
  op[9][3]= "http://www.openprocessing.org/visuals/applets/visualbcfd12e202afe0ac7a3ed7490b7a78a4/smallImage.jpg";
  op[9][4]= "http://www.openprocessing.org/visuals/applets/visualbc488b07a7662a883ffff75c5f4f395d/smallImage.jpg";
  op[9][5]= "http://www.openprocessing.org/visuals/applets/visual34a4d93006a1594a1939453326d381a2/smallImage.jpg";
  // http://www.openprocessing.org/visuals/applets/visual8107db4539744d352810329abb12e496/smallImage.jpg

  op[10][0] = "october 2008";
  op[10][1]= "10";
  op[10][2]= "http://www.openprocessing.org/visuals/applets/visual1e1dbe8a0951637234c534f008d029af/smallImage.jpg";
  op[10][3]= "http://www.openprocessing.org/visuals/applets/visual491880e477a9f32ab99cd36a5985f23e/smallImage.jpg";
  op[10][4]= "http://www.openprocessing.org/visuals/applets/visual7dbd2f2ae9a14057950fb886b16759cf/smallImage.jpg";
  op[10][5]= "http://www.openprocessing.org/visuals/applets/visual34f800d9f475665dda758071ab72b3aa/smallImage.jpg";

  op[11][0] = "November 2008";
  op[11][1]= "11";
  op[11][2]= "http://www.openprocessing.org/visuals/applets/visual1ddfc5021cee2e4cd112abd9709e18c8/smallImage.jpg";
  op[11][3]= "http://www.openprocessing.org/visuals/applets/visual5f01782bb5ff597fd1295eb40099c7c2/smallImage.jpg";
  op[11][4]= "http://www.openprocessing.org/visuals/applets/visual946fa02c76b9948b92d08b9a1f30a61f/smallImage.jpg";
  op[11][5]= "http://www.openprocessing.org/visuals/applets/visual8c88f6c58444c0a56c21017b06bd30a1/smallImage.jpg";


  op[12][0]="December 2008";
  op[12][1]= "12";
  op[12][2]= "http://www.openprocessing.org/visuals/applets/visualf3d4b735a90d55b4688da1ee8822f113/smallImage.jpg";
  op[12][3]= "http://www.openprocessing.org/visuals/applets/visual09704e4a89ca98696b71714d8b385a7c/smallImage.jpg";
  op[12][4]= "http://www.openprocessing.org/visuals/applets/visuala91913f81969115da6125de82d50eab4/smallImage.jpg";
  op[12][5]= "http://www.openprocessing.org/visuals/applets/visualf9b872e0802348740d7722b6f9b7cdd1/smallImage.jpg";


  op[13][0]="December 2008";
  op[13][1]= "13";
  op[13][2]= "http://www.openprocessing.org/visuals/applets/visual49a201deb58a0bf72bd5bbcdc5dac881/smallImage.jpg";
  op[13][3]= "http://www.openprocessing.org/visuals/applets/visual95350acc479f0144772af73389c7b322/smallImage.jpg";
  op[13][4]= "http://www.openprocessing.org/visuals/applets/visualedb3757950361212fbff92a9ed41ff60/smallImage.jpg";
  op[13][5]= "http://www.openprocessing.org/visuals/applets/visualad0f92f600dfa9474456da9b77db7774/smallImage.jpg";

  // http://www.openprocessing.org/visuals/applets/visual61cc0b82f2658d37d0d9018fa40f69cb/smallImage.jpg

  op[14][0]="January 200";
  op[14][1]= "14";
  op[14][2]= "http://www.openprocessing.org/visuals/applets/visual7fd082ee150cdf02c80666dee7e32775/smallImage.jpg";
  op[14][3]= "http://www.openprocessing.org/visuals/applets/visuale854cf661c28423171bf5a99d2fd98f4/smallImage.jpg";
  op[14][4]= "http://www.openprocessing.org/visuals/applets/visualed7c32561714f9250be700ee681a31d1/smallImage.jpg";
  op[14][5]= "http://www.openprocessing.org/visuals/applets/visual688b8eb3104d1ae0772fd5afa739c216/smallImage.jpg";

  op[15][0] = "February 2009";
  op[15][1]= "15";
  op[15][2]= "http://www.openprocessing.org/visuals/?visualID=968";
  op[15][3]= "http://www.openprocessing.org/visuals/applets/visual458f47d03edf8bf4fca5dd0cb7ef3609/smallImage.jpg";
  op[15][4]= "http://www.openprocessing.org/visuals/applets/visualf528d149b85bc1a0dde65a0c21c44b1f/smallImage.jpg";
  op[15][5]= "http://www.openprocessing.org/visuals/applets/visualfd51c634b396044948d42a14dfc917b4/smallImage.jpg";

  op[16][0]="February 2009";
  op[16][1]= "16";
  op[16][2]= "http://www.openprocessing.org/visuals/applets/visualdc729bea2ee17de6e58b26c0cee69cc7/smallImage.jpg";
  op[16][3]= "http://www.openprocessing.org/visuals/applets/visual0dbb11156083b6089a9336d5308032d2/smallImage.jpg";
  op[16][4]= "http://www.openprocessing.org/visuals/applets/visual4fb53c5f98849ca25b0317297270a4f8/smallImage.jpg";
  op[16][5]= "http://www.openprocessing.org/visuals/applets/visualc49d1e6c22fc0aaa658623f03038631f/smallImage.jpg";


  op[17][0]= "February 2009";
  op[17][1]= "17";
  op[17][2]= "http://www.openprocessing.org/visuals/applets/visual1a0e89d3e0d155ea38f17f8e3aa4fdc8/smallImage.jpg";
  op[17][3]= "http://www.openprocessing.org/visuals/applets/visual430ab151d8630e833dcbb8894ddfd506/smallImage.jpg";
  op[17][4]= "http://www.openprocessing.org/visuals/applets/visuale8a44bf8cc79ca5e15b4f0cb53fbbae3/smallImage.jpg";
  op[17][5]= "http://www.openprocessing.org/visuals/applets/visual7b25db3d0b45881ec9e76046b699e545/smallImage.jpg";

  op[18][0]="February 2009";    
  op[18][1]= "";
  op[18][2]= "http://www.openprocessing.org/visuals/applets/visual3583c3ff5ac496cad969ffed339d1bee/smallImage.jpg";
  op[18][3]= "http://www.openprocessing.org/visuals/applets/visualef53bdab79192f4b05ec4c7f0cf94085/smallImage.jpg";
  op[18][4]= "http://www.openprocessing.org/visuals/applets/visualc7adb5978340a5c988082174225307a3/smallImage.jpg";
  op[18][5]= "http://www.openprocessing.org/visuals/applets/visual58052731303324eac9fefa45d92830c8/smallImage.jpg";

  op[19][0]="February 2009";    
  op[19][1]= "";
  op[19][2]= "http://www.openprocessing.org/visuals/applets/visual0ade2b7ba05c907bce40e215177fb6ca/smallImage.jpg";
  op[19][3]= "http://www.openprocessing.org/visuals/applets/visual7dc9bec790c6f82f9fa70d7efdc5d8db/smallImage.jpg";
  op[19][4]= "http://www.openprocessing.org/visuals/applets/visuale7e68cad0ba83bda9de981a223e49701/smallImage.jpg";
  op[19][5]= "";


  op[20][0]= "February 2009";
  op[20][1]= "20";
  op[20][2]= "http://www.openprocessing.org/visuals/applets/visual73cb8f661b8c466da74340a5a4651b01/smallImage.jpg";
  op[20][3]= "http://www.openprocessing.org/visuals/applets/visual3e09c9316cdec34f27922d3fce838e9b/smallImage.jpg";
  op[20][4]= "http://www.openprocessing.org/visuals/applets/visual17c4da3a4a46aca0caea22ea52f902fb/smallImage.jpg";
  op[20][5]= "http://www.openprocessing.org/visuals/applets/visual779c54fad23075ba93bc5254914cd6cb/smallImage.jpg";

  op[21][0]="February 2009";
  op[21][1]= "21";
  op[21][2]= "http://www.openprocessing.org/visuals/applets/visual7f6e1bf25ee034e9094f64794f7c859c/smallImage.jpg";
  op[21][3]= "http://www.openprocessing.org/visuals/applets/visualf760f2334f009ebedf41230b647a0577/smallImage.jpg";
  op[21][4]= "http://www.openprocessing.org/visuals/applets/visual277f1eead073b245a2d44a210b975a7f/smallImage.jpg";
  op[21][5]= "http://www.openprocessing.org/visuals/applets/visualb95d1382fd5ed1db0633e36012343b70/smallImage.jpg";

  op[22][0]="February 2009";
  op[22][1]= "22";
  op[22][2]= "http://www.openprocessing.org/visuals/applets/visuale9aaffcff36638ce86049e8625a9b0cd/smallImage.jpg";
  op[22][3]= "http://www.openprocessing.org/visuals/applets/visuala7adfbaf904de350ecde6cc79cb5127c/smallImage.jpg";
  op[22][4]= "http://www.openprocessing.org/visuals/applets/visual86d782f7ba8292df121be6cdf24cf55f/smallImage.jpg";
  op[22][5]= "http://www.openprocessing.org/visuals/applets/visual868c9a1a75a7347d211a66121fbfbda2/smallImage.jpg";

  op[99][0]="Local List";
  op[99][1]= "99";
  op[99][2]= "1.png";
  op[99][3]= "2.png";
  op[99][4]= "3.png";
  op[99][5]= "4.png";
  //op[?][1]= "";
  //            op[?][2]= "";
  //            op[?][3]= "";
  //            op[?][4]= "";
  //            op[?][5]= "";


}






import processing.video.*;
public int pn=0;
//public boolean seethru= false;


public String savename ="k-Processing-v2-";
MovieMaker mm; 
public boolean firstpass = true;
public int frate=15;
public boolean inc = true;
public boolean addmovframe = true;
public boolean dovid =true;
public boolean looponce = false;
public boolean snap = true;

void saveget(){
  setupvid();
  if (dovid){
    if (inc){
      pn++;
    }


    save(savename+str(pn)+".png");
  }

  if (addmovframe){
    mm.addFrame();
  } 

  if (looponce){
    noLoop();
    exit(); 
  }

  if (keyPressed ==true && ( key=='`' || key =='~' || key == ESC)){
    mm.finish();
    exit(); 
  }

}

void setupvid(){
  if (firstpass)
  {
    mm = new MovieMaker(this, width, height, savename+".mov", frate, 
    MovieMaker.ANIMATION, MovieMaker.LOSSLESS);

    if (snap){
      save("snap"+savename+str(pn)+".png");
    }
    firstpass = false;


  }
}


void loop(){
  //  saveget();  //uncomment to save video
}


//December 17th 2009 
//Pixel Pull 

import peasy.org.apache.commons.math.*; 
import peasy.*; 
import peasy.org.apache.commons.math.geometry.*; 
PeasyCam cam; 
color nowcolor; 
public boolean firststart = true;
public int fmax = 5;
public int fmin = 2;
public boolean justtop =false;
int cubsize = 8; //(8+16)/2; //4-bit 
int mode =3; 
public color [] ht;
//public String file = "loading2.gif"; 
//public String file = "a.png"; 
//public String file = "5s.png"; 



public int fstart = 3;
public int defw=296;
public int defh=296;

public String file = str(fstart)+".png"; 
public boolean seethru = true;
public int tlevel = 192; // 23;
public int tmin = 0;
public int tmas = 255;

//public String file = "http://www.google.com/intl/en_ALL/images/logo.gif"; 
//public String file = "http://openprocessing.org/visuals/applets/visual0e9019479c743f134337ec58631f6f5b/smallImage.jpg"; 
public String file2 = "http://openprocessing.org/images/processingLogo.jpg"; 
public boolean gcam = true; 
PImage l,v,v2,v3,bbg; 
import processing.opengl.*; 
boolean sbox = true; 

float poppy;

PGraphics tilex,t3;
PImage tilex2;
PImage glossover ;
public boolean gloss= true;

public int w= 296;
public int h = 296;
void setup(){ 
  if (firststart){
    w =296; //450
    h = 296; //400
size (296,296,P3D);  


}
  else
  {
 size(w,h,P3D);
  }
  tilex = createGraphics(w,h,P3D);
  tilex.loadPixels();
  tilex.beginDraw();
  t3 = createGraphics(w,h,P3D);
  t3.loadPixels();
  t3.beginDraw();
  drawpic();
  t3.image(tilex,0,0,w-4,h-4);
  op = new String[200][6];
  setopstrings();
  noSmooth();
  hint(DISABLE_OPENGL_2X_SMOOTH);
  if (rmode=="OPENGL"){
    smooth();
    hint(ENABLE_OPENGL_4X_SMOOTH);
  }
  loadPixels();
  //lights();
  frameRate(frate);
  bbg= new PImage(w,h); 
  glossover= new PImage(w,h); 
  makebg(true,false,random(400)); 
  v3 = loadImage("10.png"); 
  v3.resize(w,h);
  glossover = loadImage("10.png"); 
  glossover.resize(w,h);
  arraycopy(v3.pixels,bbg.pixels);
  l = new PImage(w,h); 
  ht = new color [w*h]; 
  // creating an image to store alpha brightness
  //          v2= new PImage(w,h);
  //          //arraycopy(tilex.pixels,v2.pixels); // This results in a flat image as the brightness values are not brought over
  //          for (int px = 0;px<t3.pixels.length;px++){
  //        
  //            color dc = t3.pixels[px];
  //            float rr = red(dc);
  //            float gg = green(dc);
  //            float bb = blue(dc);
  //            float brx = brightness(dc);
  //            float brx2 = alpha(dc);
  //            color pro = color(rr,gg,bb);
  //            color pro2 = color(rr,gg,bb,23);
  //            color boxy = color(rr,gg,bb,23);
  //            color boxy2 = color(rr,gg,bb,45);
  //            ht[px]=px; 
  //            v2.pixels[px]=color(pro2,1,1,px);
  //            //  v2.pixels[px]=t3.pixels[px];
  //        
  //          }
  //          v2.updatePixels();
  //          

  // v2 = loadImage(op[ 4 ][2]); // uncomment and use v2 = loadImage (op[4..20][2]); for openprocessing images
  v2= loadImage(op[99][fstart]); //uncomment to load image from file
  //


  v2.resize(w,h);
  v = new PImage(w,h); 
  // v2 = new PImage(w,h); 


  makebg(true,false,random(0,255)); 
  arrayCopy(bbg.pixels,v.pixels); 
  makebg(true,true,mouseX); 
  arrayCopy(bbg.pixels,v3.pixels); 

  v.resize(width,height); 
  v2.resize(width,height); 
  bbg.resize(width,height); 
  arrayCopy(bbg.pixels,l.pixels); 
  if (gcam){
    if (firststart){ 
      cam = new PeasyCam (this,width); 
      firststart = false;
    }
  } 
  mode =3;

  addMouseWheelListener(new java.awt.event.MouseWheelListener() { 
    public void mouseWheelMoved(java.awt.event.MouseWheelEvent evt) { 
      mouseWheel(evt.getWheelRotation());
    }
  }
  ); 

} 

int x; 

void showimg(PImage img){
  for (int ix=0;ix<width;ix++){
    for (int iy=0;iy<height;iy++){
      set(ix,iy,img.get(ix,iy)); 
    }
  } 

}

void drawxx(){
  background(255);
if (!online){
  int cd = color (v2.pixels[mouseX+width*mouseY])  ;
  float rr =red(cd);
  float gg = green (cd);
  float bb= blue (cd);

  float brightnessx = brightness (cd);
  this.frame.setTitle( "C "+str(cd) +" B "+str(brightnessx) + " TL "+str(tlevel)   );
  }
 image(glossover,0,0); 
}
//MAIN DRAW
public float br;
void draw(){ 
  if (!online){
  int cd = color (v2.pixels[mouseX+width*mouseY])  ;
  float rr =red(cd);
  float gg = green (cd);
  float bb= blue (cd);

  float brightnessx = brightness (cd);
  this.frame.setTitle( "C "+str(cd) +" B "+str(brightnessx) + " TL "+str(tlevel)   );
  }
  poppy+=0.01;
  //directionalLight(255, 255, 255, 0, 0, -1); 



  // rotateX(poppy); //uncomment to auto-rotate
  if (!gcam){ 
    cam = null;  
  } 

  background(255); 
  // background(192,64,0); 


  //  if (mouseX > width-10 && mouseX<width-5 ||keyPressed == true){
  //    if (mouseY >height-10 && mouseY<height-5 || key == 'i'){
  //      //  background(v2);
  //      // showimg(v2);
  //      //image(v2,0,0);
  //      //arrayCopy(v2.pixels,pixels);
  //    } 
  //    else
  //    {
  //      background(255); 
  //      //  background(192,64,0); 
  //
  //    }
  //  }


  fill(233,23,23,23); 
  noStroke(); 

  if (!gcam){ 
    translate(cubsize/2,cubsize/2); 

  } 
  else 
  { 
    rotateX(radians(45)); // modify for inital rotation

    rotateZ(radians(180));

    //rotateY(radians(45));
    // scale(2); 
    translate(-width/2*1,-height/2*1); 


  } 

  for (float y=0;y<height;y+=cubsize){ 
    translate(0,y); 
    for (float x=0;x<width;x+=cubsize){ 
      int _pos = (int)x+w*(int)h;
      int pos = _pos*cubsize;
      if (!mousePressed && ( ( mouseX >x && mouseX<x+cubsize) && (mouseY>y && mouseY <y+cubsize) ) ){ 
        translate(x,0);// if (x 
        fill(233,23,23,46+23); 
        //  fill(l.get((int)x,(int)y)); 
        if(sbox){ 
          box(cubsize,cubsize,cubsize);  
        } 
        else 
        { 
          rect(0,0,cubsize,cubsize);   
          stroke(233,23,23,46+23); 
          line (0,0,0,0,0,-10); 
          line (0+cubsize,0,0,0+cubsize,0,-10); 
          line (0+cubsize,0+cubsize,0,0+cubsize,0+cubsize,-10); 
          line (0,0+cubsize,0,0,0+cubsize,-10); 
        } 
        noStroke(); 

        translate(-x,0); 
      } 
      else 
      { 
        // fill(233,23,23,46); 
        noStroke(); 
        if (mode ==1){ 
          if (gloss){
            fill(glossover.get((int)x,(int)y)); 
          }
          else
          {  
            fill(l.get((int)x,(int)y)); 
          }
          nowcolor = l.get((int)x,(int)y);

        } 
        if (mode ==2){ 
          if (gloss){
            fill(glossover.get((int)x,(int)y)); 
          }
          else
          {
            fill(v.get((int)x,(int)y)); 
          }
          nowcolor = v.get((int)x,(int)y);
        } 
        if (mode ==3){ 
          if (seethru){
            if (gloss){
              fill(glossover.get((int)x,(int)y),tlevel); 
            }
            else
            {
              fill(v2.get((int)x,(int)y),tlevel); 
            }
          }
          else
          {

            //fill(v2.get((int)x,(int)y)); 
            if (gloss){

              color pop2 = glossover.get((int)x,(int)y);
              color fix2=   shadecolor (pop2,tlevel);

              fill(fix2);
              nowcolor = fix2;

            }

            else
            {   
              color pop2 = v2.get((int)x,(int)y);
              color fix2=   shadecolor (pop2,tlevel);

              fill(fix2);
              nowcolor = fix2;
            }
          }
          nowcolor = v2.get((int)x,(int)y);
        } 

        if (mode ==4){ 
          if (gloss){

            fill(glossover.get((int)x,(int)y)); 
          }
          else
          {
            fill(v3.get((int)x,(int)y)); 
          }
          nowcolor = v3.get((int)x,(int)y);

        } 
        // float br = brightness(nowcolor);
        //br = brightness(nowcolor)+random(ht[11]);  // uncomment to fluctuate cubes
        br = brightness(nowcolor);

        if (justtop ){
          translate(x,0,-br);
        }
        else
        {
          translate(x,0,-10); 
        }

        if(sbox){ 
          if(justtop){
            box(cubsize,cubsize,cubsize);   
          }
          else
          {
            box(cubsize,cubsize,br);   
          }
        } 
        else 
        { 

          rect(0,0,cubsize,cubsize);   
          translate(0,0,br);
          rect(0,0,cubsize,cubsize);   
          translate(0,0,-br);

        } 
        //  if(!justtop){
        if (justtop ){
          translate(-x,0,br);
        }
        else
        {
          translate(-x,0,10); 
        }
        //  }

      } 
    } 
    translate(0,-y); 
  } 
  for (int p =10;p>5;p--){

    set(width-10,height-p,color(233,23,23));
    if (p==10 || p==6){
      set(width-10,height-p,color(1));
    }
    set(width-9,height-p,color(233,23,23));
    set(width-8,height-p,color(233,23,23));
    set(width-7,height-p,color(233,23,23));
    set(width-6,height-p,color(233,23,23));
    set(width-5,height-p,color(233,23,23));
    if (p==10 || p==6){
      set(width-5,height-p,color(1));
    }
  }


  if (mouseX > width-10 && mouseX<width-5 ||keyPressed == true){
    if (mouseY >height-10 && mouseY<height-5 || key == 'i' || key =='I'){
      background(v2);
      if (key =='i'){
        showimg(v2);
      }

      if (key =='I'){
        showimg(glossover); 
      }
      //image(v2,0,0);
      //arrayCopy(v2.pixels,pixels);
    } 
    //    else
    //    {
    //      background(255); 
    //      //  background(192,64,0); 
    //
    //    }
  }

  //  loop();
} 

void keyPressed(){ 

  if (key =='r'){
    w= defw;
    h=defh;
    setup();

  } 
  // println(keyCode);
  if (key=='g'){
    gloss = !gloss; 
  }
  if (key =='j'){
    justtop = !justtop;
  }

  if (key=='q'){
    if (w>150&& h > 150){
      w--;   
      h--;
      if (!online){
        println("width : "+str(w));
        println("height : "+str(h));
      }
      setup();
    }
  }

  if (key=='Q'){
    if (w<500 && h <500){
      w++; 
      h++;  
      if (!online){
        println("width : "+str(w));
        println("height : "+str(h));
      }

      setup();
    }
  }



  // uncomment to use Open processing processing images as images

  //  if (keyCode ==37){ //left
  //    fstart--;
  //    if (fstart<fmin){
  //      fstart=fmin; 
  //    }
  //    file = str(fstart)+".png"; 
  //    v2= loadImage(file); 
  //    v2.updatePixels();   
  //    setup();
  //  }
  //
  //  if (keyCode ==39){ //right
  //    fstart++;
  //
  //    if (fstart>fmax){
  //      fstart = fmax; 
  //    }
  //    file = str(fstart)+".png"; 
  //    v2= loadImage(file); 
  //    v2.updatePixels();  
  //    setup();
  //  }


  if (keyCode ==38){ //up

    cubsize++;   

  }

  if (keyCode ==40){ //down

    cubsize--;   

  }


  if (key=='+'){ 
    cubsize++;   
  } 

  if (key=='-'){ 
    cubsize--;   
  } 

  if (cubsize<1){ 
    cubsize = 1;  
  } 

  if (cubsize > width/2) {   

    cubsize =  width/2;   

  } 

  if (key=='c'){ 
    gcam = !gcam;  
    setup(); 
  } 


  if (key=='1'){ 
    mode=1;  
  } 
  if (key=='2'){ 
    makebg(true,true,mouseX+mouseY); 
    arrayCopy(bbg.pixels,v.pixels); 
    mode=2;   
  } 
  if (key=='3'){ 
    // makebg(true,true,mouseY); 
    //  arrayCopy(bbg.pixels,v2.pixels); 
    mode=3; 
  } 
  if (key=='4'){ 
    makebg(true,true,mouseX); 
    arrayCopy(bbg.pixels,v3.pixels); 
    mode=4; 
  } 

  if (key =='s'){
    seethru = !seethru; 
  }

  if (key =='b'){ 
    sbox = !sbox;  
  } 

  if (!online){
    println(fstart);
     save("pillowv2.png"); 
  } 
} 

int cpass=0;  
void makebg(Boolean animate, Boolean invert,float pval){  

  bbg.loadPixels();  
  color colx = 0;  
  for(int y=0;y<height;y++){  
    for(int x=0;x<width;x++){  
      int pos=y*width+x;  
      color col = bbg.pixels[pos] ;//  
      colx = color(height-y,x,y-x);   
      if (animate){  
        //colx = color(height-y,X,cpass+y);   
        colx = color(height-y,x,cpass-X);   
        //  colx = color(mouseY-y,x,cpass+y);   
      }  

      if (pval>0){ 
        colx = color(pval-x,y,pval+y); 
      } 


      float rr= red(colx);  
      float bb= blue(colx);  
      float gg= green(colx);  

      rr = colx >> 16 & 0xff;  
      gg = colx >> 8 & 0xff;  
      bb = colx  & 0xff;  
      //        for(int i=0;i<4;i++){  
      //          dis =dist(p[i].xpos,p[i].ypos,x,y)/2;  
      //          rr += cc[0]/dis-gain;  
      //          gg += cc[1]/dis-gain;  
      //          bb += cc[2]/dis-gain;  
      //        }  
      if (!invert)    {   
        bbg.pixels[pos]=color(rr,gg,bb); 
      }  
      if (invert)   {    
        bbg.pixels[pos]=-color(rr,gg,bb); 
      }  
    }  
    //  arraycopy(v3.pixels,bbg.pixels);
    bbg.updatePixels();  
    ////    if (!online){  
    //    arraycopy(bbg.pixels,water.pixels);   
    ////    }  
  }  
  if (animate){  
    cpass++;   
  }  
  if (cpass>4000){   
    cpass=0;    
  }   


}  

int zoomStep = 1;

void mouseWheel(int delta) {
  if(delta > 0) {
    tlevel -= zoomStep;
    //controlP5.controller("zoom").setValue(zoomFactor);
  }
  else {
    tlevel += zoomStep;
    //controlP5.controller("zoom").setValue(zoomFactor); 
  }
  if (tlevel >255){
    tlevel = 255; 
  }

  if (tlevel <0){
    tlevel = 0; 
  }
  println(tlevel);
}



color shadecolor(color c, float val)
{
  return color(red(c)+val,green(c)+val,blue(c)+val, alpha(c));  
}


int vv,p,k,ll=0;
void drawpic(){ 
  background(255); 
  color popp = color(-1);
  tilex.background(popp); 
  //tilex2.background(popp); 
  // tilex3.background(popp); 
  if (vv<2){
    vv++;

    //for( int o=0;o<300*300;o++){ 
    for( int o=0;o<w*h;o++){ 
      // p+=mouseX; 
      //   k-=mouseX; 

      p+=vv;//ll; //uncomment to save pics 
      k-=vv;//ll; //uncomment to save pics   

      if (p>w*h-1){ 
        p=0;  
      } 

      if (p<1){ 
        k=300*300;  
      } 
      // stroke(233,23,23);

      int _x= (int)p/w; 
      int _x1= (int)k/w; 
      int _y = p-(_x*w); 
      int _y1 = k-(_x1*w); 
      stroke(1); 
      // stroke(lv2[3].get(_y,_x));
      //   fill(lv2[3].get(_y,_x));
      //  stroke(34,139,34,102); 
      // tilex.stroke(34,139,34,102); 
      //tilex.stroke(255);
      // noStroke();
      //fill(34,139,34,102); 
      //     if (o%70==0){
      //      stroke(random(0,255),random(0,255),random(0,255));
      //     }
      //    point(_x,_y);  
      //    point(_y,_x);  
      //    point(_x1,_y1);  
      //    point(_y1,_x1);  


      //set(_x,_y,1);  
      //set(_y,_x,1);  
      //set(_x1,_y1,1);  
      //set(_y1,_x1,1);  


      color pop  = color(1);
      tilex.set(_x,_y,1);  
      tilex.set(_y,_x,1);  
      tilex.set(_x1,_y1,1);  
      tilex.set(_y1,_x1,1);

    } 

    if (keyPressed){
      ll++;

      if (!online){  
        if (key=='s'){
          println(ll);
          save(str(ll)+".png");
          tilex.updatePixels();
          tilex.save("4z.png");
        }
      }
    }




    tilex.updatePixels();

  }

} 




